<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • fishgrowbot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="fishgrowbot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fishgrowbot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nschiett/fishgrowbot/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nschiett/fishgrowbot/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>Somatic growth of fishes is a fundamental trait that determines essential ecosystem services such as food provision and nutrient cycling. Growth rate information can be derived through age estimation based on the analysis of sagittal otoliths. While fitting growth models on size-at-age data is the most frequently employed approach to deriving growth parameters, this method requires a high number of individuals. An alternative approach based on back-calculation can provide approximations to individual-level growth trajectories. <code>fishgrowbot</code> provides functions to perform the back-calculation in a Bayesian framework. Further, the package provides a Bayesian framework to fit the von Bertalanffy growth model to the back-calculated lengths in a hierarchical structure. Finally, <code>fishgrowbot</code> provides functions to visualize the results. In this vignette, we provide an introduction to <code>fishgrowbot</code> through a case study. For more theoretical background of the methodology, see <a href="https://doi.org/10.1038/s41597-020-00711-y">Morat et al. (2020)</a></p>
<p>First things first: we need to load some packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://nschiett.github.io/fishgrowbot">fishgrowbot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span></code></pre></div>
<p>To introduce the functionalities of <code>fishgrowbot</code>, we look at an example for <em>Epinephelus merra</em>. The function <code><a href="../reference/bcalc.html">bcalc()</a></code> returns both a dataframe with the back-calculated lengths and their uncertainty and the model object for more details on the fit of the <code>bc</code> stan model.</p>
<p>The input data should contain:<br>
+ id: Unique fish id per individual.<br>
+ radi: Measurements of otolith growth rings (in mm).<br>
+ agei: Age estimation of fish.<br>
+ lencap: Length at capture (in mm).<br>
+ radcap: Radius of otolith at capture (in mm).<br>
+ l0p: Length of fish at hatching (in mm).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get data</span>
<span class="va">em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">coral_reef_fishes_data</span>, <span class="va">species</span> <span class="op">==</span> <span class="st">"Epinephelus merra"</span>,
             <span class="va">location</span> <span class="op">==</span> <span class="st">"Moorea"</span><span class="op">)</span>
<span class="co"># back-calculation</span>
<span class="va">bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcalc.html">bcalc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">em</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'stan_bcalc' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 4.6e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.46 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 0.628127 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                0.213846 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                0.841973 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'stan_bcalc' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 2.6e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.26 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 0.658096 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                0.190219 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                0.848315 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'stan_bcalc' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 2.6e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.26 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 0.598406 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                0.203322 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                0.801728 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'stan_bcalc' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 2.7e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.27 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 0.696645 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                0.190861 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                0.887506 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span>
<span class="co">#&gt;                   id age      l_m         l_sd     l_lb     l_ub</span>
<span class="co">#&gt; 1 EP_ME_MO_03_16_001   0   1.5000 1.094098e-15   1.5000   1.5000</span>
<span class="co">#&gt; 2 EP_ME_MO_03_16_001   1 154.3969 5.747777e+00 143.2196 165.8864</span>
<span class="co">#&gt; 3 EP_ME_MO_03_16_001   2 178.4719 4.542739e+00 169.5591 187.4810</span>
<span class="co">#&gt; 4 EP_ME_MO_03_16_001   3 192.2266 3.718605e+00 184.8975 199.5706</span>
<span class="co">#&gt; 5 EP_ME_MO_03_16_001   4 205.7123 2.823156e+00 200.1250 211.2665</span>
<span class="co">#&gt; 6 EP_ME_MO_03_16_001   5 217.7985 1.951656e+00 213.9225 221.6255</span></code></pre></div>
<p>The function <code>bcplot</code> helps visualize the back calculation. Some examples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bcplot.html">bcplot</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/plot1a-1.png" width="768"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bcplot.html">bcplot</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="va">lengths</span>, colorid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/plot1b-1.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bcplot.html">bcplot</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="va">lengths</span>, colorid <span class="op">=</span> <span class="cn">TRUE</span>, facet <span class="op">=</span> <span class="cn">TRUE</span>, error <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/plot1c-1.png" width="768"></p>
<p>Then, we can fit the hierarchical von Bertalanffy growth model that allows for the estimation of multiple parameters. Importantly, length measures should be given in cm.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit growth model</span>
<span class="va">growthmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/growthreg.html">growthreg</a></span><span class="op">(</span>length <span class="op">=</span> <span class="va">bc</span><span class="op">$</span><span class="va">lengths</span><span class="op">$</span><span class="va">l_m</span> <span class="op">/</span> <span class="fl">10</span>, age <span class="op">=</span>  <span class="va">bc</span><span class="op">$</span><span class="va">lengths</span><span class="op">$</span><span class="va">age</span>,
                         id <span class="op">=</span>  <span class="va">bc</span><span class="op">$</span><span class="va">lengths</span><span class="op">$</span><span class="va">id</span>, lmax <span class="op">=</span> <span class="fl">32</span>, linf_m <span class="op">=</span> <span class="fl">28</span>,
                         linf_sd <span class="op">=</span> <span class="fl">5</span>, l0_m <span class="op">=</span> <span class="fl">0.15</span>, l0_sd <span class="op">=</span> <span class="fl">0.015</span>, iter <span class="op">=</span> <span class="fl">4000</span>,
                         open_progress <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'vonbert' NOW (CHAIN 1).</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Gradient evaluation took 9.1e-05 seconds</span>
<span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.91 seconds.</span>
<span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 1200 / 4000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 1600 / 4000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 2000 / 4000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 1: Iteration: 2001 / 4000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 2400 / 4000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 2800 / 4000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 3200 / 4000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 3600 / 4000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; Chain 1:  Elapsed Time: 9.02519 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 1:                8.61429 seconds (Sampling)</span>
<span class="co">#&gt; Chain 1:                17.6395 seconds (Total)</span>
<span class="co">#&gt; Chain 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'vonbert' NOW (CHAIN 2).</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Gradient evaluation took 6.6e-05 seconds</span>
<span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.66 seconds.</span>
<span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 1200 / 4000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 1600 / 4000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 2000 / 4000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 2: Iteration: 2001 / 4000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 2400 / 4000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 2800 / 4000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 3200 / 4000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 3600 / 4000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; Chain 2:  Elapsed Time: 8.06386 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 2:                9.16747 seconds (Sampling)</span>
<span class="co">#&gt; Chain 2:                17.2313 seconds (Total)</span>
<span class="co">#&gt; Chain 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'vonbert' NOW (CHAIN 3).</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Gradient evaluation took 6.3e-05 seconds</span>
<span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.63 seconds.</span>
<span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3: Iteration:    1 / 4000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  400 / 4000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration:  800 / 4000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 1200 / 4000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 1600 / 4000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 2000 / 4000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 3: Iteration: 2001 / 4000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 2400 / 4000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 2800 / 4000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 3200 / 4000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 3600 / 4000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: Iteration: 4000 / 4000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; Chain 3:  Elapsed Time: 8.61785 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 3:                8.78801 seconds (Sampling)</span>
<span class="co">#&gt; Chain 3:                17.4059 seconds (Total)</span>
<span class="co">#&gt; Chain 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; SAMPLING FOR MODEL 'vonbert' NOW (CHAIN 4).</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Gradient evaluation took 6.4e-05 seconds</span>
<span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.64 seconds.</span>
<span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4: Iteration:    1 / 4000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  400 / 4000 [ 10%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration:  800 / 4000 [ 20%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 1200 / 4000 [ 30%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 1600 / 4000 [ 40%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 2000 / 4000 [ 50%]  (Warmup)</span>
<span class="co">#&gt; Chain 4: Iteration: 2001 / 4000 [ 50%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 2400 / 4000 [ 60%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 2800 / 4000 [ 70%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 3200 / 4000 [ 80%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 3600 / 4000 [ 90%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: Iteration: 4000 / 4000 [100%]  (Sampling)</span>
<span class="co">#&gt; Chain 4: </span>
<span class="co">#&gt; Chain 4:  Elapsed Time: 8.51591 seconds (Warm-up)</span>
<span class="co">#&gt; Chain 4:                7.94622 seconds (Sampling)</span>
<span class="co">#&gt; Chain 4:                16.4621 seconds (Total)</span>
<span class="co">#&gt; Chain 4:</span>
<span class="co"># summary growth parameters</span>
<span class="va">growthmodel</span><span class="op">$</span><span class="va">summary</span>
<span class="co">#&gt;             mean      se_mean         sd        2.5%         25%         50%</span>
<span class="co">#&gt; k     0.64500216 0.0011817646 0.05322081  0.54717396  0.60845060  0.64330753</span>
<span class="co">#&gt; linf 14.98841579 0.0396914129 0.99755766 13.17927923 14.31739695 14.94247952</span>
<span class="co">#&gt; l0    0.42359669 0.0035471324 0.23882775 -0.03527297  0.26052457  0.42071421</span>
<span class="co">#&gt; t0   -0.04558787 0.0003963115 0.02682001 -0.10130897 -0.06328039 -0.04439278</span>
<span class="co">#&gt; kmax  0.39891902 0.0007970229 0.04093070  0.32519590  0.36980951  0.39684584</span>
<span class="co">#&gt;              75%        97.5%</span>
<span class="co">#&gt; k     0.67876680  0.754984657</span>
<span class="co">#&gt; linf 15.60498651 17.139827563</span>
<span class="co">#&gt; l0    0.58686006  0.902953359</span>
<span class="co">#&gt; t0   -0.02695131  0.003399286</span>
<span class="co">#&gt; kmax  0.42554647  0.484199802</span></code></pre></div>
<p>We can use existing packages <code>rstan</code> and <code>bayesplot</code> to make diagnostic plots.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan">rstan</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: StanHeaders</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; rstan (Version 2.21.2, GitRev: 2e1f913d3ca3)</span>
<span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span>
<span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span>
<span class="co">#&gt; rstan_options(auto_write = TRUE)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/">bayesplot</a></span><span class="op">)</span>
<span class="co">#&gt; This is bayesplot version 1.8.0</span>
<span class="co">#&gt; - Online documentation and vignettes at mc-stan.org/bayesplot</span>
<span class="co">#&gt; - bayesplot theme set to bayesplot::theme_default()</span>
<span class="co">#&gt;    * Does _not_ affect other ggplot2 plots</span>
<span class="co">#&gt;    * See ?bayesplot_theme_set for details on theme setting</span>
<span class="co"># Posterior predictive check</span>
<span class="va">yrep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html">extract</a></span><span class="op">(</span><span class="va">growthmodel</span><span class="op">$</span><span class="va">stanfit</span>, <span class="st">"y_rep"</span><span class="op">)</span><span class="op">$</span><span class="va">y_rep</span>
<span class="fu"><a href="https://mc-stan.org/bayesplot/reference/PPC-distributions.html">ppc_dens_overlay</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">bc</span><span class="op">$</span><span class="va">lengths</span><span class="op">$</span><span class="va">l_m</span> <span class="op">/</span> <span class="fl">10</span>, yrep <span class="op">=</span> <span class="va">yrep</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#trace plots</span>
<span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-extract.html">extract</a></span><span class="op">(</span><span class="va">growthmodel</span><span class="op">$</span><span class="va">stanfit</span>, permuted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">posterior</span>,  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"linf"</span>, <span class="st">"k"</span><span class="op">)</span>,
                facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, labeller <span class="op">=</span> <span class="va">label_parsed</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">facet_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-2-2.png" width="768"></p>
<p>Now we can visualize the fit with the function <code><a href="../reference/gmplot.html">gmplot()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gmplot.html">gmplot</a></span><span class="op">(</span><span class="va">growthmodel</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/plot2a-1.png" width="768"></p>
<p>Setting <code>id = TRUE</code>, we can see the individual growth curves.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gmplot.html">gmplot</a></span><span class="op">(</span><span class="va">growthmodel</span>, id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/plot2b-1.png" width="768"></p>
<p>If there are many individuals, the id graph can quickly get crowded. Set <code>facet = TRUE</code> to have a subplot per individual.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gmplot.html">gmplot</a></span><span class="op">(</span><span class="va">growthmodel</span>, id <span class="op">=</span> <span class="cn">TRUE</span>, facet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_files/figure-html/plot2c-1.png" width="768"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nina M. D. Schiettekatte.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
